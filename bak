
  celerybeat:
    build:
      path: ./compose/django
    command: celery -A capitolzen.tasks beat --workdir=/app -l INFO
    health:
      interval: 5
      path: /
      timeout: 4
    port:
      port: 0
      scheme: ""
    scale:
      count:
        min: 1
        max: 1
      memory: 256
    resources:
      - database
  celeryworker:
    build:
      path: ./compose/django
    command: celery -A capitolzen.tasks worker --workdir=/app --concurrency=4 -l INFO
    health:
      interval: 5
      path: /
      timeout: 4
    port:
      port: 0
      scheme: ""
    scale:
      count:
        min: 1
        max: 1
      memory: 256
    resources:
      - database

  django:
    build:
      path: ./compose/django
      context: .
    command: /gunicorn.sh
    health:
      interval: 5
      path: /
      timeout: 3
    port:
      port: 0
      scheme: ""
    scale:
      count:
        min: 1
        max: 1
      memory: 256
    resources:
      - database
